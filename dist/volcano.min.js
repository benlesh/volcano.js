!function(a){"use strict";function b(){var a=this,b=!1;a.stop=function(){b=!0},a.isStopped=function(){return b}}function c(a,b,c){return[].slice.call(a,b,c)}function d(a){return"boolean"==typeof a}function e(a){return Object.prototype.toString.call(a)}function f(a){return"[object Array]"===e(a)}function g(a){return"object"==typeof a}function h(a){return"function"==typeof a}function i(a){return"string"==typeof a}function j(a){return"undefined"==typeof a}function k(a,c){if(a){var d=new b;if(f(a))for(var e=0;e<a.length&&(c(a[e],e,a,d),!d.isStopped());e++);else if(g(a))for(var h in a)if(a.hasOwnProperty(h)&&(c(a[h],h,a,d),d.isStopped()))break}}function l(a,b){if(!a||!f(a))return void 0;var c=[];return k(a,function(a,d,e,f){c.push(b(a,d,e,f))}),c}function m(a,b){var c;return k(a,function(a,d,e,f){b(a,d,e,f)&&(c=a,f.stop())}),c}function n(a,b){return!!m(a,b)}function o(a){var b,e=!1;j(a)&&(a={}),d(a)?(e=a,a=src,b=c(arguments,2)):b=c(arguments,1),k(b,function(b){k(b,function(b,c){e&&g(b)?(a[c]=a[c]||{},o(e,a[c],b)):a[c]=b})})}function p(a,b,c){var d=A.__namespaces__[a]=A.__namespaces__[a]||{};return b&&(g(b)?o(d,b):i(b)?d[b]=c:h(b)&&b(d)),d}function q(a){var b=a.split(".");return{fullName:a,namespace:b.slice(0,b.length-1).join("."),type:b[b.length-1]}}function r(a,b){A.__iocContainer__[a]=q(b),B.dirty=!0}function s(){if(f(arguments[0]))return s.apply(this,arguments[0]);B.dirty&&u();var b=c(arguments,0,arguments.length-1),d=arguments[arguments.length-1];a.console.log(b,d);var e=l(b,t);return function(){return d.apply(this,e)}}function t(a){var b,c=A.__iocContainer__[a],d=A.__namespaces__[c.namespace][c.type];if(!c.value)switch(d.type){case"var":return d.dependencies?(b=d.dependencies.concat([e]),s(b)()):d.value;case"const":return d.value;case"singleton":if(!d.value){var e=d.init;d.dependencies?(b=d.dependencies.concat([e]),d.value=s(b)()):d.value=e()}return d.value;case"class":var f=d.ctor;return d.dependencies&&(b=d.dependencies.concat([f]),f=s(b)),new f}return c.value}function u(){var b=new z;a.console.log("updateDependencies"),k(A.__iocContainer__,function(c,d){a.console.log("ud: ",c,d),b.add(d,c,v(c.namespace,c.type))}),b.prioritized(),B.chain=b}function v(a,b){return A.__namespaces__[a][b].dependencies}function w(a){x(),r("$start",a);var b=t("$start");if(!f(b.main)&&!h(b.main))throw new Error(a+" does not have a function main()");s(b.main)()}function x(){k(A.__namespaces__,function(a){k(a,function(a,b,c){if(!(g(a)&&a instanceof y)){var d=new y(b,a);c[b]=d}})})}function y(a,b){var c=this;if(c.name=a,c.original=b,C.test(a))c.type="const",c.value=b;else if(D.test(a)){if(c.type="class",h(b)?c.ctor=b:f(b)&&(c.dependencies=b.slice(0,b.length-2),c.ctor=b[b.length-1]),!c.ctor)throw new Error("invalid class declaration")}else if(E.test(a)){c.type="singleton";var d=b;f(b)&&(c.dependencies=b.slice(0,b.length-2),d=b[b.length-1]),h(d)?c.init=d:g(d)&&(c.instance=d)}else{if(!F.test(a))throw new Error("invalid name "+a);c.type="var",f(b)?(c.dependencies=b.slice(0,b.length-2),c.init=b[b.length-1]):c.value=b}}function z(){function a(a){var b,c;for(b=0;b<h.length;b++)if(h[b].name===a)return h[b];return m=!0,c=new e(a),h.push(c),c}function b(){(null===o||m)&&(o=j.run())}function c(){return n(o,function(a){return a.length>1})}function d(a){this.vertices=a||[]}function e(a,b){this.name=a||null,this.value=b||null,this.connections=[],this.index=-1,this.lowlink=-1}function f(a){this.vertices=a||[]}function g(a){this.index=0,this.stack=new f,this.graph=a,this.scc=[],this.run=function(){for(var a=0;a<this.graph.vertices.length;a++)this.graph.vertices[a].index<0&&this.strongconnect(this.graph.vertices[a]);return this.scc},this.strongconnect=function(a){a.index=this.index,a.lowlink=this.index,this.index=this.index+1,this.stack.vertices.push(a);for(var b in a.connections){var c=a,d=a.connections[b];if(!d)throw new Error("missing dependency: "+b);d.index<0?(this.strongconnect(d),c.lowlink=Math.min(c.lowlink,d.lowlink)):this.stack.contains(d)&&(c.lowlink=Math.min(c.lowlink,d.index))}if(a.lowlink==a.index){var e=[],f=null;if(this.stack.vertices.length>0)do f=this.stack.vertices.pop(),e.push(f);while(!a.equals(f));e.length>0&&this.scc.push(e)}}}var h=[],i=new d(h),j=new g(i),m=!1,o=null,p=this;p.add=function(b,c,d){var e=a(b);return e.value=c,k(d,function(b){e.connections.push(a(b))}),e},p.prioritized=function(){if(b(),c())throw new Error("Circular dependencies detected");return l(o,function(a){return a[0]})},e.prototype={equals:function(a){return a.name&&this.name===a.name}},f.prototype.contains=function(a){for(var b=0;b<this.vertices.length;b++)if(this.vertices[b].equals(a))return!0;return!1}}var A={};A.__namespaces__={},A.__iocContainer__={};var B=A.__iocState__={dirty:!0,chain:null},C=/^[A-Z][A-Z_0-9]?$/,D=/^[A-Z][A-Za-z0-9]+$/,E=/^[a-z][A-Za-z-0-9]*Singleton$/,F=/^[a-z][A-Za-z-0-9]*$/;o(A,{extend:o,forEach:k,map:l,first:m,any:n,isArray:f,isBoolean:d,isFunction:h,isObject:g,isString:i,slice:c,objectString:e,namespace:p,bootstrap:w,register:r,inject:s,getInjection:t}),a.volcano=a.$v=A;var G=p("volcano");G.ioc={register:r,inject:s,getInjection:t},r("ioc","volcano.ioc"),G.window=a,r("window","volcano.window")}(window);
//# sourceMappingURL=volcano.min.map