!function(a){"use strict";function b(){var a=this,b=!1;a.stop=function(){b=!0},a.isStopped=function(){return b}}function c(a,b,c){return[].slice.call(a,b,c)}function d(a){return a[a.length-1]}function e(a){return a.slice(0,a.length-1)}function f(a){return"boolean"==typeof a}function g(a){return Object.prototype.toString.call(a)}function h(a){return"[object Array]"===g(a)}function i(a){return"object"==typeof a}function j(a){return"function"==typeof a}function k(a){return"string"==typeof a}function l(a){return"undefined"==typeof a}function m(a,c){if(a){var d=new b;if(h(a))for(var e=0;e<a.length&&(c(a[e],e,a,d),!d.isStopped());e++);else if(i(a))for(var f in a)if(a.hasOwnProperty(f)&&(c(a[f],f,a,d),d.isStopped()))break}}function n(a,b){if(!a||!h(a))return void 0;var c=[];return m(a,function(a,d,e,f){c.push(b(a,d,e,f))}),c}function o(a,b){var c;return m(a,function(a,d,e,f){b(a,d,e,f)&&(c=a,f.stop())}),c}function p(a,b){return!!o(a,b)}function q(a){var b,d=!1;l(a)&&(a={}),f(a)?(d=a,a=src,b=c(arguments,2)):b=c(arguments,1),m(b,function(b){m(b,function(b,c){d&&i(b)?(a[c]=a[c]||{},q(d,a[c],b)):a[c]=b})})}function r(a,b,c){var d=C.__namespaces__[a]=C.__namespaces__[a]||{};return b&&(i(b)?q(d,b):k(b)?d[b]=c:j(b)&&b(d)),d}function s(a){var b=a.split(".");return{fullName:a,namespace:e(b).join("."),type:d(b)}}function t(a,b){C.__iocContainer__[a]=s(b),D.dirty=!0}function u(){if(h(arguments[0]))return u.apply(this,arguments[0]);D.dirty&&w();var a=c(arguments),b=e(a),f=d(a),g=n(b,v);return function(){return f.apply(this,g)}}function v(a){var b,c=C.__iocContainer__[a],d=C.__namespaces__[c.namespace][c.type];if(!c.value)switch(d.type){case"var":return d.dependencies?(b=d.dependencies.concat([e]),u(b)()):d.value;case"const":return d.value;case"singleton":if(!d.value){var e=d.init;d.dependencies?(b=d.dependencies.concat([e]),d.value=u(b)()):d.value=e()}return d.value;case"class":var f=d.ctor;return d.dependencies&&(b=d.dependencies.concat([f]),f=u(b)),new f}return c.value}function w(){var b=new B;a.console.log("updateDependencies"),m(C.__iocContainer__,function(c,d){a.console.log("ud: ",c,d),b.add(d,c,x(c.namespace,c.type))}),b.prioritized(),D.chain=b}function x(a,b){return C.__namespaces__[a][b].dependencies}function y(a){z(),t("$start",a);var b=v("$start");if(!h(b.main)&&!j(b.main))throw new Error(a+" does not have a function main()");u(b.main)()}function z(){m(C.__namespaces__,function(a){m(a,function(a,b,c){if(!(i(a)&&a instanceof A)){var d=new A(b,a);c[b]=d}})})}function A(a,b){var c=this;c.name=a,c.original=b,I.lastIndex=0;var f=I.exec(a);if(f){try{c.attrs=JSON.parse(attrsParts[1])}catch(g){throw new Error("Error parsing attrs: "+g)}a=attrsParts[2]}J.lastIndex=0;var k=J.exec(a);if(k&&(c.visibility="private"===k[2]||"_"===k[3]?"private":"protected"===k[2]||"_"===k[3]?"protected":"public",a=k[4]),E.test(a))c.type="const",c.value=b;else if(F.test(a)){if(c.type="class",j(b)?c.ctor=b:h(b)&&(c.dependencies=e(b),c.ctor=d(b)),!c.ctor)throw new Error("invalid class declaration")}else if(G.test(a)){c.type="singleton";var l=b;h(b)&&(c.dependencies=e(b),l=d(b)),j(l)?c.init=l:i(l)&&(c.instance=l)}else{if(!H.test(a))throw new Error("invalid name "+a);c.type="var",h(b)?(c.dependencies=e(b),c.init=d(b)):c.value=b}}function B(){function a(a){var b,c;for(b=0;b<h.length;b++)if(h[b].name===a)return h[b];return k=!0,c=new e(a),h.push(c),c}function b(){(null===l||k)&&(l=j.run())}function c(){return p(l,function(a){return a.length>1})}function d(a){this.vertices=a||[]}function e(a,b){this.name=a||null,this.value=b||null,this.connections=[],this.index=-1,this.lowlink=-1}function f(a){this.vertices=a||[]}function g(a){this.index=0,this.stack=new f,this.graph=a,this.scc=[],this.run=function(){for(var a=0;a<this.graph.vertices.length;a++)this.graph.vertices[a].index<0&&this.strongconnect(this.graph.vertices[a]);return this.scc},this.strongconnect=function(a){a.index=this.index,a.lowlink=this.index,this.index=this.index+1,this.stack.vertices.push(a);for(var b in a.connections){var c=a,d=a.connections[b];if(!d)throw new Error("missing dependency: "+b);d.index<0?(this.strongconnect(d),c.lowlink=Math.min(c.lowlink,d.lowlink)):this.stack.contains(d)&&(c.lowlink=Math.min(c.lowlink,d.index))}if(a.lowlink==a.index){var e=[],f=null;if(this.stack.vertices.length>0)do f=this.stack.vertices.pop(),e.push(f);while(!a.equals(f));e.length>0&&this.scc.push(e)}}}var h=[],i=new d(h),j=new g(i),k=!1,l=null,o=this;o.add=function(b,c,d){var e=a(b);return e.value=c,m(d,function(b){e.connections.push(a(b))}),e},o.prioritized=function(){if(b(),c())throw new Error("Circular dependencies detected");return n(l,function(a){return a[0]})},e.prototype={equals:function(a){return a.name&&this.name===a.name}},f.prototype.contains=function(a){for(var b=0;b<this.vertices.length;b++)if(this.vertices[b].equals(a))return!0;return!1}}var C={};C.__namespaces__={},C.__iocContainer__={};var D=C.__iocState__={dirty:!0,chain:null},E=/^[A-Z][A-Z_0-9]?$/,F=/^[A-Z][A-Za-z0-9]+$/,G=/^[a-z][A-Za-z-0-9]*Singleton$/,H=/^[a-z][A-Za-z-0-9]*$/,I=/^\s*(\{.*\})\s*(.*)$/,J=/^\s*((private|protected)\s*|(_|$))([A-Za-z0-9_$].*)$/;q(C,{extend:q,forEach:m,map:n,first:o,any:p,isArray:h,isBoolean:f,isFunction:j,isObject:i,isString:k,slice:c,objectString:g,namespace:r,bootstrap:y,register:t,inject:u,getInjection:v}),a.volcano=a.$v=C;var K=r("volcano");K.ioc={register:t,inject:u,getInjection:v},t("ioc","volcano.ioc"),K.window=a,t("window","volcano.window")}(window);
//# sourceMappingURL=volcano.min.map